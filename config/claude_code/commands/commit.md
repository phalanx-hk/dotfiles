# Claude コマンド: Commit

このコマンドは、emoji を利用した Conventional Commits 形式を利用して、適切にフォーマットされたコミットの作成を支援します。

## 使用方法

コミットを作成するには次のように入力してください

```
/commit
```

## このコマンドは以下の手順を実行します
1. 現在のブランチが`main`または`master`でないことを確認します
2. `main`または`master`ブランチの場合、`git diff`を実行してコミットされる変更内容を確認して、適切なブランチに切り替えてください　
2. `git status`でどのファイルがステージされているかを確認します
3. ステージされたファイルが 0 個の場合、`git add`で変更されたファイルと新しいファイルを自動的に追加してください
4. `git diff`を実行してコミットされる変更内容を理解してください
5. diff を分析して、複数の異なる論理的変更が含まれているかを判定します
6. もし複数の論理的変更がある場合、それらを別々のコミットに分割してください
7. 各コミット（または分割されない場合は単一のコミット）に対して、emoji を利用した conventional commit 形式を使用してコミットメッセージを作成
8. コミットを実行し、pre-commit チェックが失敗した場合は問題を修正してください　

## 重要な注意事項

- デフォルトでは、コード品質を確保するために pre-commit チェックが実行されます
- これらのチェックが失敗した場合に`--no-verify`オプションを使用してコミットすることは推奨されません
- pre-commitのチェックが成功するよう、pre--commitのエラーメッセージをもとに問題を修正してください
- 特定のファイルが既にステージされている場合、コマンドはそれらのファイルのみをコミットします
- ステージされたファイルがない場合、変更されたファイルと新しいファイルを自動的にステージします
- コミットメッセージは検出された変更に基づいて構築されます
- コミット前に、複数のコミットがより適切かどうかを判断するために diff をレビューします
- 複数のコミットを提案する場合、変更を別々にステージしてコミットするのを支援します
- 常にコミット diff をレビューして、メッセージが変更と一致することを確認します


## コミットのベストプラクティス

- **コミット前の確認**: コードが lint されて正常にビルドでき、ドキュメントが更新されていることを確認しましょう
- **アトミックコミット**: 各コミットは単一の目的を果たすよう関連する変更を含むべき
- **大きな変更の分割**: 変更が複数の異なる論理的変更が含まれている場合は、別々のコミットに分割
- **Conventional commit 形式**: `<type>: <description>`の形式を使用。type は以下のいずれか：
  - `feat`: 新機能
  - `fix`: バグ修正
  - `docs`: ドキュメント変更
  - `style`: コードスタイル変更（フォーマットなど）
  - `refactor`: バグ修正でも機能追加でもないコード変更
  - `perf`: パフォーマンス改善
  - `test`: テストの追加または修正
  - `chore`: ビルドプロセス、ツールなどの変更
- **命令法**: コミットメッセージはコマンドとして記述（例：「機能を追加しました」ではなく「機能を追加」）
- **Emoji**: 各コミットタイプには適切な emoji が対応：
  - `feat`: ✨
  - `fix`: 🐛
  - `docs`: 📝
  - `style`: 💄
  - `refactor`: ♻️
  - `perf`: ⚡️
  - `test`: ✅
  - `chore`: 🔧

## コミット分割のガイドライン

diff を分析する際、以下の基準に基づいてコミットの分割を検討してください：

1. **異なる関心事**: コードベースの無関係な部分への変更
2. **異なるタイプの変更**: 機能、修正、リファクタリングなどの混在
3. **ファイルパターン**: 異なるタイプのファイルへの変更（例：ソースコード vs ドキュメント）
4. **論理的グループ分け**: 別々に理解またはレビューした方が分かりやすい変更
5. **サイズ**: 分割した方が明確になる非常に大きな変更

## 例

良いコミットメッセージ：

- ✨ feat: cloud run のサービスアカウントを追加
- 🐛 fix: llm の推論タイムアウト時間を変更
- 📝 docs: exp002 の実験に関するドキュメントを記載
- 💄 style: 読みやすさ向上のためにコンポーネント構造を再編成
- ♻️ refactor: パーサーのエラーハンドリングロジックを簡素化
- 🔧 chore: 開発者ツールのセットアッププロセスを改善

コミット分割の例：

- 1 つ目のコミット: ✨ feat: 新しい solc バージョンの型定義を追加
- 2 つ目のコミット: 📝 docs: 新しい solc バージョンのドキュメントを更新
- 3 つ目のコミット: 🔧 chore: package.json の依存関係を更新
- 4 つ目のコミット: ✨ feat: 新しい API エンドポイントの型定義を追加
- 5 つ目のコミット: ✨ feat: ワーカースレッドの並行性処理を改善
- 6 つ目のコミット: 🐛 fix: 新しいコードのリント問題を解決
- 7 つ目のコミット: ✅ test: 新しい solc バージョン機能のユニットテストを追加
- 8 つ目のコミット: 🐛 fix: セキュリティ脆弱性のある依存関係を更新
